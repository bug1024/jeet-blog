---
layout:     post
title:      "负载均衡"
subtitle:   "负载均衡策略"
date:       2017-08-27
author:     "Bug1024"
header-img: "img/post-bg-uml.jpeg"
tags:
    - Architecture
---

# 负载均衡分类
## 二层负载均衡
对外依然提供一个VIP，集群中不同的机器采用相同IP地址，但是机器的MAC地址不一样。当负载均衡服务器接受到请求之后，通过改写报文的目标MAC地址的方式将请求转发到目标机器实现负载均衡。

## 三层负载均衡
对外提供一个VIP，但是集群中不同的机器采用不同的IP地址。当负载均衡服务器接受到请求之后，根据不同的负载均衡算法，通过IP将请求转发至不同的真实服务器。

## 四层负载均衡
四层负载均衡工作在OSI模型的传输层，由于在传输层，只有TCP/UDP协议，这两种协议中除了包含源IP、目标IP以外，还包含源端口号及目的端口号。四层负载均衡服务器在接受到客户端请求后，以后通过修改数据包的地址信息（IP+端口号）将流量转发到应用服务器。

## 七层负载均衡
七层负载均衡工作在OSI模型的应用层，应用层协议较多，常用http、radius、dns等。七层负载就可以基于这些协议来负载。这些应用层协议中会包含很多有意义的内容。比如同一个Web服务器的负载均衡，除了根据IP加端口进行负载外，还可根据七层的URL、浏览器类别、语言来决定是否要进行负载均衡。

# 负载均衡工具
硬件负载均衡性能优越，功能全面，但是价格昂贵，因此软件负载均衡在互联网领域大量使用。常用的软件负载均衡软件有Nginx，Lvs，HaProxy等。
* Nginx 七层负载均衡
* LVS Linux Virtual Server，也就是Linux虚拟服务器，四层负载均衡
* HaProxy C语言编写的自由及开放源代码软件，其提供高可用性、负载均衡，以及基于TCP和HTTP的应用程序代理，七层负载均衡

# 负载均衡算法
通常可以分成静态负载均衡算法和动态负载均衡算法
* 静态负载均衡算法 轮询，比率，优先权
* 动态负载均衡算法 最少连接数，最快响应速度，观察方法，预测法，动态性能分配，动态服务器补充，服务质量，服务类型，规则模式
